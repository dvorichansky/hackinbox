"use strict";function ownKeys(n,o){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);o&&(c=c.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),e.push.apply(e,c)}return e}function _objectSpread(n){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?ownKeys(e,!0).forEach(function(o){_defineProperty(n,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):ownKeys(e).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(e,o))})}return n}function _defineProperty(n,o,e){return o in n?Object.defineProperty(n,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[o]=e,n}function _classCallCheck(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,o){for(var e=0;e<o.length;e++){var c=o[e];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(n,c.key,c)}}function _createClass(n,o,e){return o&&_defineProperties(n.prototype,o),e&&_defineProperties(n,e),n}!function(){var n=function(){function n(){_classCallCheck(this,n),this.hackinbox=document.querySelector(".hackinbox"),this.hackinboxOverlay=document.querySelector(".hackinbox-overlay"),this.hackinboxClose=document.querySelectorAll("[data-hackinbox=close]")}return _createClass(n,[{key:"hackinboxHide",value:function(){this.hackinboxOverlay.style.cssText="display:none !important",this.hackinbox.style.cssText="display:none !important",c()}},{key:"hackinboxShow",value:function(){this.hackinboxOverlay.style.cssText="display:block !important",this.hackinbox.style.cssText="display:block !important"}},{key:"hackinboxEventClose",value:function(){var n=this;this.hackinboxClose.forEach(function(o){return o.addEventListener("click",n.hackinboxHide.bind(n))})}}]),n}(),o="".concat(location.origin,"/hackinbox/"),e="".concat(o,"hackinbox_data.json");function c(){!function(n,o){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(e=_objectSpread({path:"/"},e)).expires&&(e.expires=e.expires.toUTCString());var c=encodeURIComponent(n)+"="+encodeURIComponent(o);for(var t in e){c+="; "+t;var a=e[t];!0!==a&&(c+="="+a)}document.cookie=c}("hackinbox","loaded",{"max-age":86400})}fetch(e).then(function(n){if(200===n.status)return console.log("Successful connection!"),n.json();300===n.status&&console.log("Queue...")}).then(function(e){if(!function(n){if(n){var o=n.some(function(n){return n==location.hostname+location.pathname});return console.log(o?"Page excluded for hackinbox":"The page is allowed to display hackbox"),o}}(e.exception_pages)){if("OFF"==e.status)return c();var t,a,r,i,s,l;!function(n){var e=n.hackinbox_content,c=n.hackinbox_form,t=n.hackinbox_counter,a=n.hackinbox_appearance;document.body.insertAdjacentHTML("beforeend",'<div class="hackinbox">\n            <div class="hackinbox-container">\n                <div class="hackinbox-picture">\n                    <img class="hackinbox-picture__img" src="'.concat(o,'img/hackinbox_picture.png" />\n                </div>\n                <div class="hackinbox-content">                                  \n                    <a href="javascript:void(0)" class="hackinbox-close" data-hackinbox="close">×</a>\n                    <div class="hackinbox-content__title">').concat(e.title,'</div>\n\n                    <div class="hackinbox-counter">\n                        <div class="hackinbox-counter__title">').concat(t.title,'</div>\n                        <div class="hackinbox-counter-clock">\n                            <div class="hackinbox-counter-clock__dig">\n                                <div class="hackinbox-counter-clock__number hackinbox-counter-clock__number-hours">00</div>\n                                <div class="hackinbox-counter-clock__name">часы</div>\n                            </div>\n                            <div class="hackinbox-counter-clock__dz"></div>\n                            <div class="hackinbox-counter-clock__dig">\n                                <div class="hackinbox-counter-clock__number hackinbox-counter-clock__number-minutes">23</div>\n                                <div class="hackinbox-counter-clock__name">минуты</div>\n                            </div>\n                            <div class="hackinbox-counter-clock__dz"></div>\n                            <div class="hackinbox-counter-clock__dig">\n                                <div class="hackinbox-counter-clock__number hackinbox-counter-clock__number-seconds">58</div>\n                                <div class="hackinbox-counter-clock__name">секунды</div>\n                            </div>\n                        </div>\n                    </div>\n                \n                    <form class="hackinbox-form" action="POST">\n                        <input type="hidden" name="form" value="').concat(c.name,'">\n                        <input type="hidden" name="referer" value="').concat(location.href,'">\n                        <input \n                          type="text" \n                          name="phone" \n                          class="hackinbox-form__input hackinbox-form__userphone" \n                          value="').concat(c.mask,'"\n                          placeholder="').concat(c.placeholder,'" \n                          maxlength="34">\n                        <small class="hackinbox-form__message-error">').concat(c.userphone_message_error,'</small>\n                        <button \n                          type="submit" \n                          class="hackinbox-form__button"\n                        >').concat(c.button,'</button>  \n                        <div class="hackinbox-form__success">\n                            <div class="hackinbox-form__success-text">').concat(c.success_text,'</div>\n                            <button \n                              type="button" \n                              class="hackinbox-form__button hackinbox-form__success-button" \n                              data-hackinbox="close">').concat(c.success_button,'</button>\n                        </div>                      \n                    </form>                    \n                </div>\n            </div>\n        </div>\n        <div class="hackinbox-overlay" data-hackinbox="close"></div>\n        <style id="hackinbox_style">\n          ').concat(a.box_shadow?".hackinbox{box-shadow:".concat(a.box_shadow,"}"):"","\n          ").concat(e.background_color?".hackinbox-content{background-color:#".concat(e.background_color,"}"):"","\n          ").concat(e.title_color?".hackinbox-content__title{color:#".concat(e.title_color,"}"):"","\n          ").concat(a.overlay?".hackinbox-overlay{background-color:#".concat(a.overlay.background_color,";opacity:").concat(a.overlay.opacity,"}"):"","\n          ").concat(c.button_color?".hackinbox-form__button{background-color:#".concat(c.button_color,";}"):"","\n          ").concat(c.success_button_color?".hackinbox-form__success-button{background-color:#".concat(c.success_button_color,";}"):"","\n          ").concat(t.color||t.background_color?".hackinbox-counter-clock__number,.hackinbox-counter-clock__dz:before,.hackinbox-counter-clock__dz:after{background-color:#".concat(t.background_color,";color:#").concat(t.color,";}"):"","\n        </style>"))}(e),t=e.hackinbox_form.configuration_file,a=$(".hackinbox-form [name=phone]"),r=$(".hackinbox-form [type=submit]"),function(n){n.addEventListener("input",function(){var n=this.defaultValue,o=0,e=n.replace(/\D/g,""),c=this.value.replace(/\D/g,"");e.length>=c.length&&(c=e),n=n.replace(/[_\d]/g,function(n){return c.charAt(o++)||"_"}),this.value=n,(o=n.lastIndexOf(c.substr(-1)))<n.length&&n!=this.defaultValue?o++:o=n.indexOf("_"),function(n,o){if(o.focus(),o.setSelectionRange)o.setSelectionRange(n,n);else if(o.createTextRange){var e=o.createTextRange();e.collapse(!0),e.moveEnd("character",n),e.moveStart("character",n),e.select()}}(o,this)},!1)}(i=document.querySelector(".hackinbox-form [name=phone]")),document.addEventListener("submit",function(n){var e=n.target;e.classList.contains("hackinbox-form")&&(n.preventDefault(),-1===i.value.indexOf("_")?(a.removeClass("hackinbox-form__userphone-error"),r.prop("disabled",!0),$.ajax({type:"POST",url:"".concat(o,"test_submit/test_submit.php"),data:$(e).serialize(),dataType:"html",success:function(){console.log("Test passed!")},error:function(){console.log("Test failed!")}}),$.ajax({type:"POST",url:t,data:$(e).serialize(),dataType:"html",beforeSend:function(){},success:function(n){$(e).contents().filter(function(){return"hackinbox-form__success"!=this.classList}).remove(),$(".hackinbox-counter, .hackinbox-content__title").remove(),c()},error:function(){}})):a.addClass("hackinbox-form__userphone-error"))}),s=e.hackinbox_counter.deadline,l=60*+s.hours*60+60*+s.minutes+ +s.seconds,function(n,o){var e=document.querySelector(n),c=".hackinbox-counter-clock__number",t=e.querySelector("".concat(c,"-hours")),a=e.querySelector("".concat(c,"-minutes")),r=e.querySelector("".concat(c,"-seconds"));function i(){var n=function(n){var o=Date.parse(n)-Date.parse(new Date),e=Math.floor(o/1e3%60),c=Math.floor(o/1e3/60%60),t=Math.floor(o/36e5%24);return{total:o,hours:t,minutes:c,seconds:e}}(o);t.innerHTML=("0"+n.hours).slice(-2),a.innerHTML=("0"+n.minutes).slice(-2),r.innerHTML=("0"+n.seconds).slice(-2),n.total<=0&&clearInterval(s)}i();var s=setInterval(i,1e3)}(".hackinbox-counter-clock",new Date(Date.parse(new Date)+1e3*l)),setTimeout(function(){var o=new n;o.hackinboxShow(),o.hackinboxEventClose()},1e3*+e.display_delay)}}).catch(function(n){throw n})}();